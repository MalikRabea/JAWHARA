<!-- SubCategories Management with Amazing Tailwind UI -->
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-6">
    <div class="w-full mx-auto space-y-8">

        <!-- Header Section -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 animate-fade-in">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
                <div class="space-y-2">
                    <h1
                        class="text-4xl lg:text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent">
                        <i class="fas fa-layer-group text-purple-500 mr-3 animate-bounce"></i>
                        SubCategories Management
                    </h1>
                    <p class="text-gray-600 text-lg">Manage your product subcategories with ease and style</p>
                </div>

                <div class="flex flex-col sm:flex-row gap-4">
                    <button
                        class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 hover:scale-105"
                        (click)="openSubCategoryForm()" [disabled]="loading">
                        <i class="fas fa-plus mr-2"></i>
                        {{showSubCategoryForm ? 'Close SubCategory Form' : 'Add New SubCategory'}}
                    </button>
                </div>
            </div>
        </div>

        <!-- Search and Filter Section -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6 animate-slide-down">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Search Input -->
                <div class="space-y-2">
                    <label class=" text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fas fa-search text-blue-500 mr-2"></i>
                        Search SubCategories
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                        <input type="text"
                            class="block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 bg-white/90 backdrop-blur-sm"
                            placeholder="Search subcategories..." [(ngModel)]="searchTerm" (keyup.enter)="onSearch()"
                            [disabled]="loading">
                        <button class="absolute inset-y-0 right-0 pr-3 flex items-center" (click)="onSearch()"
                            [disabled]="loading">
                            <i class="fas fa-search text-blue-500 hover:text-blue-700 transition-colors"></i>
                        </button>
                    </div>
                </div>

                <!-- Category Filter -->
                <div class="space-y-2">
                    <label class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fas fa-filter text-blue-500 mr-2"></i>
                        Filter by Category
                    </label>
                    <select
                        class="block w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 bg-white/90 backdrop-blur-sm"
                        [(ngModel)]="selectedCategoryId" (change)="onCategoryFilterChange()" [disabled]="loading">
                        <option [value]="null">All Categories</option>
                        <option *ngFor="let category of categories" [value]="category.id">
                            {{ category.name }}
                        </option>
                    </select>
                </div>
            </div>
        </div>

        <!-- SubCategory Form Section (Show/Hide with smooth transitions) -->
        <div class="transition-all duration-500 ease-in-out transform" [class.opacity-100]="showSubCategoryForm"
            [class.max-h-screen]="showSubCategoryForm" [class.opacity-0]="!showSubCategoryForm"
            [class.max-h-0]="!showSubCategoryForm" [class.overflow-hidden]="!showSubCategoryForm">

            <div
                class="bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 p-8 animate-slide-down">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 flex items-center">
                        <i class="fas fa-edit text-purple-500 mr-3"></i>
                        {{ isEditingSubCategory ? 'Edit SubCategory' : 'Create New SubCategory' }}
                    </h3>
                    <button
                        class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-300"
                        (click)="closeSubCategoryForm()">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <form [formGroup]="subCategoryForm" (ngSubmit)="saveSubCategory()" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- SubCategory Name -->
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700 flex items-center">
                                <i class="fas fa-tag text-blue-500 mr-2"></i>
                                SubCategory Name
                            </label>
                            <input type="text"
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 bg-white/90"
                                formControlName="name" placeholder="Enter subcategory name"
                                [class.border-red-500]="subCategoryForm.get('name')?.invalid && subCategoryForm.get('name')?.touched"
                                [class.border-green-500]="subCategoryForm.get('name')?.valid && subCategoryForm.get('name')?.touched">
                            <div class="text-red-500 text-sm flex items-center mt-1"
                                *ngIf="subCategoryForm.get('name')?.invalid && subCategoryForm.get('name')?.touched">
                                <i class="fas fa-exclamation-circle mr-1"></i>
                                SubCategory name is required and must be at least 2 characters
                            </div>
                        </div>

                        <!-- Category Selection -->
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700 flex items-center">
                                <i class="fas fa-layer-group text-blue-500 mr-2"></i>
                                Parent Category
                            </label>
                            <select
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 bg-white/90"
                                formControlName="categoryId"
                                [class.border-red-500]="subCategoryForm.get('categoryId')?.invalid && subCategoryForm.get('categoryId')?.touched"
                                [class.border-green-500]="subCategoryForm.get('categoryId')?.valid && subCategoryForm.get('categoryId')?.touched">
                                <option value="">Select a category</option>
                                <option *ngFor="let category of categories" [value]="category.id">
                                    {{ category.name }}
                                </option>
                            </select>
                            <div class="text-red-500 text-sm flex items-center mt-1"
                                *ngIf="subCategoryForm.get('categoryId')?.invalid && subCategoryForm.get('categoryId')?.touched">
                                <i class="fas fa-exclamation-circle mr-1"></i>
                                Please select a parent category
                            </div>
                        </div>
                    </div>

                    <!-- Description -->
                    <div class="space-y-2">
                        <label class="block text-sm font-semibold text-gray-700 flex items-center">
                            <i class="fas fa-align-left text-blue-500 mr-2"></i>
                            Description
                        </label>
                        <textarea
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 bg-white/90 resize-none"
                            formControlName="description" placeholder="Enter subcategory description (optional)"
                            rows="3"></textarea>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-4 pt-4">
                        <button type="button"
                            class="flex-1 px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-105"
                            (click)="closeSubCategoryForm()">
                            <i class="fas fa-times mr-2"></i>
                            Cancel
                        </button>
                        <button type="submit"
                            class="flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"
                            [disabled]="subCategoryForm.invalid || loading">
                            <i class="fas fa-save mr-2" *ngIf="!loading"></i>
                            <i class="fas fa-spinner fa-spin mr-2" *ngIf="loading"></i>
                            {{ isEditingSubCategory ? 'Update SubCategory' : 'Create SubCategory' }}
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- SubCategories List Section -->
        <div class="space-y-6">
            <!-- Loading State -->
            <div class="text-center py-12" *ngIf="loading">
                <div
                    class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full mb-4">
                    <i class="fas fa-spinner fa-spin text-white text-2xl"></i>
                </div>
                <p class="text-gray-600 text-lg font-medium">Loading subcategories...</p>
            </div>

            <!-- SubCategories Table -->
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 overflow-hidden"
                *ngIf="!loading && subCategories.length > 0">

                <!-- Table Header -->
                <div class="bg-gradient-to-r from-blue-500 to-purple-600 px-6 py-4">
                    <h3 class="text-white text-lg font-semibold flex items-center">
                        <i class="fas fa-table mr-2"></i>
                        SubCategories Overview
                    </h3>
                </div>

                <!-- Table Content -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 border-b border-gray-200">
                            <tr>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-hashtag mr-1"></i>
                                    ID
                                </th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-tag mr-1"></i>
                                    Name
                                </th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-layer-group mr-1"></i>
                                    Parent Category
                                </th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-align-left mr-1"></i>
                                    Description
                                </th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-calendar-plus mr-1"></i>
                                    Created
                                </th>
                                <th
                                    class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-calendar-edit mr-1"></i>
                                    Updated
                                </th>
                                <th
                                    class="px-6 py-4 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <i class="fas fa-cogs mr-1"></i>
                                    Actions
                                </th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50 transition-colors duration-200 group"
                                *ngFor="let subCategory of subCategories; trackBy: trackBySubCategoryId">

                                <!-- ID Column -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div
                                            class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center text-white text-sm font-bold">
                                            {{ subCategory.id }}
                                        </div>
                                    </div>
                                </td>

                                <!-- Name Column -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div
                                            class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center text-white mr-3">
                                            <i class="fas fa-tag"></i>
                                        </div>
                                        <div>
                                            <div
                                                class="text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors duration-200">
                                                {{ subCategory.name }}
                                            </div>
                                        </div>
                                    </div>
                                </td>

                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                      <div class="w-8 h-8 ...">
                                        <i class="fas fa-layer-group text-xs"></i>
                                      </div>
                                      <div class="text-sm text-gray-600">
                                        {{ subCategory.categoryName || getCategoryName(subCategory.categoryId) }}
                                      </div>
                                    </div>
                                  </td>

                                <!-- Description Column -->
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-600 max-w-xs">
                                        <p *ngIf="subCategory.description" class="truncate">
                                            {{ subCategory.description }}
                                        </p>
                                        <p *ngIf="!subCategory.description"
                                            class="text-gray-400 italic flex items-center">
                                            <i class="fas fa-info-circle mr-1"></i>
                                            No description
                                        </p>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-600" *ngIf="subCategory?.createdAt">
                                        {{ subCategory.createdAt | date:'short' }}
                                    </div>
                                    <div *ngIf="!subCategory?.createdAt" class="text-gray-400 italic">
                                        N/A
                                    </div>
                                </td>

                                <!-- Updated At Column -->
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-600" *ngIf="subCategory.updatedAt">
                                        <div class="flex items-center">
                                            <i class="fas fa-calendar-edit text-gray-400 mr-2"></i>
                                            {{ subCategory.updatedAt | date:'short' }}
                                        </div>
                                    </div>
                                    <div class="text-sm text-gray-400 italic" *ngIf="!subCategory.updatedAt">
                                        N/A
                                    </div>
                                </td>

                                <!-- Actions Column -->
                                <td class="px-6 py-4 whitespace-nowrap text-center">
                                    <div class="flex items-center justify-center space-x-2">
                                        <button
                                            class="inline-flex items-center px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-xs font-semibold rounded-lg transition-all duration-300 hover:scale-105"
                                            (click)="openSubCategoryForm(subCategory)" title="Edit subcategory">
                                            <i class="fas fa-edit mr-1"></i>
                                            Edit
                                        </button>
                                        <button
                                            class="inline-flex items-center px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-semibold rounded-lg transition-all duration-300 hover:scale-105"
                                            (click)="deleteSubCategory(subCategory)" title="Delete subcategory">
                                            <i class="fas fa-trash mr-1"></i>
                                            Delete
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Table Footer -->
                <div class="bg-gray-50 px-6 py-3 border-t border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="text-sm text-gray-600">
                            <span class="font-medium">{{ subCategories.length }}</span> subcategories found
                        </div>
                        <div class="text-sm text-gray-500">
                            <i class="fas fa-info-circle mr-1"></i>
                            Click edit or delete to manage subcategories
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="text-center py-16" *ngIf="!loading && subCategories.length === 0">
                <div
                    class="w-24 h-24 bg-gradient-to-r from-gray-300 to-gray-400 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-layer-group text-white text-3xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">No SubCategories Found</h3>
                <p class="text-gray-600 mb-6 max-w-md mx-auto">
                    {{ searchTerm || selectedCategoryId ? 'No subcategories match your search criteria.' : 'Get started
                    by creating your first subcategory.' }}
                </p>
                <button
                    class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300"
                    (click)="openSubCategoryForm()" *ngIf="!searchTerm && !selectedCategoryId">
                    <i class="fas fa-plus mr-2"></i>
                    Create First SubCategory
                </button>
            </div>
        </div>

        <!-- Pagination Section -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6"
            *ngIf="!loading && totalPages > 1">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <div class="flex items-center space-x-2">
                    <button
                        class="px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
                        [class.opacity-50]="currentPage === 1" (click)="onPageChange(currentPage - 1)"
                        [disabled]="currentPage === 1">
                        <i class="fas fa-chevron-left mr-1"></i>
                        Previous
                    </button>

                    <div class="flex space-x-1">
                        <button class="px-3 py-2 text-sm font-medium rounded-lg transition-all duration-300"
                            [class.bg-blue-500]="page === currentPage" [class.text-white]="page === currentPage"
                            [class.text-gray-600]="page !== currentPage"
                            [class.hover:bg-gray-100]="page !== currentPage" *ngFor="let page of getPageNumbers()"
                            (click)="onPageChange(page)">
                            {{ page }}
                        </button>
                    </div>

                    <button
                        class="px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
                        [class.opacity-50]="currentPage === totalPages" (click)="onPageChange(currentPage + 1)"
                        [disabled]="currentPage === totalPages">
                        Next
                        <i class="fas fa-chevron-right ml-1"></i>
                    </button>
                </div>

                <div class="text-sm text-gray-600">
                    Page {{ currentPage }} of {{ totalPages }}
                </div>
            </div>
        </div>
    </div>
</div>