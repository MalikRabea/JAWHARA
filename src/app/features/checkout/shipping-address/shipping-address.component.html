<div class="space-y-6">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex items-center justify-center py-8">
    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <span class="ml-2 text-gray-600">Loading address...</span>
  </div>

  <!-- Existing Address Section -->
  <div *ngIf="!isLoading && userAddress && !showNewAddressForm" class="space-y-4">
    <div class="flex items-center justify-between">
      <h3 class="text-lg font-medium text-gray-900">Shipping Address</h3>
      <button
        type="button"
        (click)="onEditAddress()"
        class="text-blue-600 hover:text-blue-700 font-medium text-sm"
      >
        Edit Address
      </button>
    </div>

    <!-- Address Display -->
    <div class="border border-gray-200 rounded-lg p-6 bg-gray-50">
      <div class="flex items-start justify-between">
        <div class="flex-1">
          <h4 class="font-medium text-gray-900 mb-3">{{ userAddress.fullName }}</h4>
          <div class="text-sm text-gray-600 space-y-1">
            <p>{{ userAddress.street }}</p>
            <p>{{ userAddress.city }}{{ userAddress.state ? ', ' + userAddress.state : '' }} {{ userAddress.postalCode }}</p>
            <p>{{ userAddress.country }}</p>
            <p class="mt-2 text-gray-500">{{ userAddress.phone }}</p>
          </div>
        </div>
        <div class="flex items-center text-green-600">
          <i class="hs-icon hs-icon-check-circle text-lg mr-1"></i>
          <span class="text-sm font-medium">Verified</span>
        </div>
      </div>
    </div>

    <!-- Use This Address Button -->
    <div class="flex justify-end pt-4 border-t border-gray-200">
      <button
        type="button"
        (click)="onUseExistingAddress()"
        class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
      >
        Use This Address
      </button>
    </div>
  </div>

  <!-- New/Edit Address Form -->
  <div *ngIf="showNewAddressForm" class="space-y-6">
    <div class="flex items-center justify-between">
      <h3 class="text-lg font-medium text-gray-900">
        {{ userAddress ? 'Edit Address' : 'Add Shipping Address' }}
      </h3>
      <button
        *ngIf="userAddress"
        type="button"
        (click)="showNewAddressForm = false"
        class="text-gray-600 hover:text-gray-700 font-medium text-sm"
      >
        ‚Üê Back to Address
      </button>
    </div>

    <form [formGroup]="shippingForm" (ngSubmit)="onSubmit()" class="space-y-6">
      <!-- Full Name -->
      <div>
        <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">
          Full Name *
        </label>
        <input
          type="text"
          id="fullName"
          formControlName="fullName"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
          placeholder="Enter your full name"
        >
        <p *ngIf="getFieldError('fullName')" class="text-red-500 text-sm mt-1">
          {{ getFieldError('fullName') }}
        </p>
      </div>

      <!-- Phone -->
      <div>
        <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
          Phone Number *
        </label>
        <input
          type="tel"
          id="phone"
          formControlName="phone"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
          placeholder="Enter your phone number"
        >
        <p *ngIf="getFieldError('phone')" class="text-red-500 text-sm mt-1">
          {{ getFieldError('phone') }}
        </p>
      </div>

      <!-- Street Address -->
      <div>
        <label for="street" class="block text-sm font-medium text-gray-700 mb-2">
          Street Address *
        </label>
        <input
          type="text"
          id="street"
          formControlName="street"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
          placeholder="Enter your street address"
        >
        <p *ngIf="getFieldError('street')" class="text-red-500 text-sm mt-1">
          {{ getFieldError('street') }}
        </p>
      </div>

      <!-- City and State -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="city" class="block text-sm font-medium text-gray-700 mb-2">
            City *
          </label>
          <input
            type="text"
            id="city"
            formControlName="city"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
            placeholder="Enter your city"
          >
          <p *ngIf="getFieldError('city')" class="text-red-500 text-sm mt-1">
            {{ getFieldError('city') }}
          </p>
        </div>

        <div>
          <label for="state" class="block text-sm font-medium text-gray-700 mb-2">
            State/Province
          </label>
          <input
            type="text"
            id="state"
            formControlName="state"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
            placeholder="Enter your state"
          >
        </div>
      </div>

      <!-- Postal Code and Country -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="postalCode" class="block text-sm font-medium text-gray-700 mb-2">
            Postal Code *
          </label>
          <input
            type="text"
            id="postalCode"
            formControlName="postalCode"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
            placeholder="Enter your postal code"
          >
          <p *ngIf="getFieldError('postalCode')" class="text-red-500 text-sm mt-1">
            {{ getFieldError('postalCode') }}
          </p>
        </div>

        <div>
          <label for="country" class="block text-sm font-medium text-gray-700 mb-2">
            Country *
          </label>
          <select
            id="country"
            formControlName="country"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
          >
            <option value="">Select your country</option>
            <option value="US">United States</option>
            <option value="CA">Canada</option>
            <option value="GB">United Kingdom</option>
            <option value="AU">Australia</option>
            <option value="DE">Germany</option>
            <option value="FR">France</option>
            <option value="IT">Italy</option>
            <option value="ES">Spain</option>
            <option value="NL">Netherlands</option>
            <option value="BE">Belgium</option>
          </select>
          <p *ngIf="getFieldError('country')" class="text-red-500 text-sm mt-1">
            {{ getFieldError('country') }}
          </p>
        </div>
      </div>

      <!-- Default Address Checkbox -->
      <div class="flex items-center">
        <input
          type="checkbox"
          id="isDefault"
          formControlName="isDefault"
          class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
        >
        <label for="isDefault" class="ml-2 block text-sm text-gray-700">
          Set as default shipping address
        </label>
      </div>

      <!-- Submit Button -->
      <div class="flex justify-end pt-6 border-t border-gray-200">
        <button
          type="submit"
          [disabled]="isSubmitting"
          class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center"
        >
          <span *ngIf="isSubmitting" class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></span>
          {{ isSubmitting ? 'Saving...' : (userAddress ? 'Update Address' : 'Save & Continue') }}
        </button>
      </div>
    </form>
  </div>

  <!-- No Address State -->
  <div *ngIf="!isLoading && !userAddress && !showNewAddressForm" class="text-center py-8">
    <div class="text-gray-500 mb-4">
      <i class="hs-icon hs-icon-location text-4xl"></i>
    </div>
    <h3 class="text-lg font-medium text-gray-900 mb-2">No shipping address</h3>
    <p class="text-gray-600 mb-4">Add your shipping address to continue with checkout</p>
    <button
      type="button"
      (click)="onAddNewAddress()"
      class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
    >
      Add Address
    </button>
  </div>
</div>